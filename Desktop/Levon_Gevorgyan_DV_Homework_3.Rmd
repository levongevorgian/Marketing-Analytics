---
title: "Levon_Gevorgyan_DV_Homework_3"
output: html_document
date: "2025-03-09"
---


### Libraries

```{r}
library(dplyr)
library(ggplot2)
library(readr)
```


### The Dataset

```{r}
mobiles <- read_csv("mobiles_dataset.csv")
```


### Checking for null values

```{r}
sum(is.na(mobiles))
```


## Part 1: Analytical Questions


### Converting Currencies to Dollars

```{r}
mobiles <- mobiles %>%
  mutate(
    USD_Pakistan = Launched.Price.Pakistan.PKR * 0.0036,
    USD_India = Launched.Price.India.INR * 0.011,
    USD_China = Launched.Price.China.CNY * 0.14,
    USD_USA = Launched.Price.USA.USD,
    USD_Dubai = Launched.Price.Dubai.AED * 0.27
  )
```


### 1. Does battery capacity influence the launched price of a smartphone? Check this variability across all currencies. Is there any type of difference between behaviors?

```{r}
mobiles_converted1 <- data.frame()

for (country in c("USD_Pakistan", "USD_India", "USD_China", "USD_USA", "USD_Dubai")) {
  temp <- data.frame(
    Battery.Capacity = mobiles$Battery.Capacity.mAh,
    Price = mobiles[[country]],
    Country = country
  )
  mobiles_converted1 <- rbind(mobiles_converted1, temp)
}

ggplot(mobiles_converted1, aes(x = Battery.Capacity, y = Price, color = Country)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method = "lm", se = FALSE) +
  facet_wrap(~ Country, scales = "free") +
  theme_minimal() +
  labs(title = "Battery Capacity vs Launched Price (USD)", 
       x = "Battery Capacity (mAh)", y = "Launch Price (USD)")


# correlation

cor_results1 <- mobiles %>% 
  select(Battery.Capacity.mAh, USD_Pakistan, USD_India, USD_China, USD_USA, USD_Dubai) %>%
  cor(use = "complete.obs")
print(cor_results1)


# linear regression model

lm_model1 <- list()
for (country in c("USD_Pakistan", "USD_India", "USD_China", "USD_USA", "USD_Dubai")) {
  formula <- as.formula(paste0(country, " ~ Battery.Capacity.mAh"))
  lm_model1[[country]] <- lm(formula, data = mobiles)
}

lapply(lm_model1, summary)
```
The regression lines are almost flat (slightly negative slopped) which means that there's no strong relationship between battery capacity and price. We can see that, for example, Apple or Sony who have premium models but still not the highest capacity, they are still sold by the highest price. So, only battery capacity does not indicate a strong relationship. Almost all the countries seem to have the same relationship of pricing and battery capacity. Only a slight change in the amount of pricing regarding the battery capacity, for example, the models with the highest battery capacity have a price of around 2500 in Pakistan and China, whereas in India, Dubai and the USA it's around 3000. Now, looking at the correlation and linear regression summary, we can clearly see a weak (negative) correlation between all the countries' price and battery capacity meaning there's a very weak relationship between these two features. Also, the negative battery capacity coefficients for all countries suggest higher battery capacity tends to slightly lower the price, but the effect is minimal (this is the case I mentioned about Apple and Sony). Moreover, the p-value for battery capacity coefficients is greater than 0.05, which means that battery capacity is not a statistically significant predictor of price in any of the countries. Also, R-squared values are very low, also meaning that battery capacity influencing price has very little or no influence.


### 2. Does RAM size impact the price of smartphones? Check this variability across all currencies. Is there any type of difference between behaviors?

```{r}
mobiles$RAM <- as.numeric(gsub("GB", "", mobiles$RAM))

mobiles_converted2 <- data.frame()
for (country in c("USD_Pakistan", "USD_India", "USD_China", "USD_USA", "USD_Dubai")) {
  temp <- data.frame(
    RAM.Size = mobiles$RAM,
    Price = mobiles[[country]],
    Country = country
  )
  mobiles_converted2 <- rbind(mobiles_converted2, temp)
}

ggplot(mobiles_converted2, aes(x = RAM.Size, y = Price, color = Country)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method = "lm", se = FALSE) +
  facet_wrap(~ Country, scales = "free") +
  theme_minimal() +
  labs(title = "RAM Size vs Launched Price (USD)", 
       x = "RAM Size (GB)", y = "Launch Price (USD)") +
  theme(axis.text.x = element_text(size = 6, angle = 45, hjust = 1))


# correlation

cor_results2 <- mobiles %>%
  select(RAM, USD_Pakistan, USD_India, USD_China, USD_USA, USD_Dubai) %>%
  cor(use = "complete.obs")
print(cor_results2)


# linear regression model

lm_model2 <- list()
for (country in c("USD_Pakistan", "USD_India", "USD_China", "USD_USA", "USD_Dubai")) {
  formula <- as.formula(paste0(country, " ~ RAM"))
  lm_model2[[country]] <- lm(formula, data = mobiles)
}

lapply(lm_model2, summary)
```

Compared to battery capacity and price analysis, in RAM and price analysis we can clearly see a positive trend (slope) in all the countries' graphs, which means - as RAM increases, price tends to increase as well. The difference is just the pricing (in Pakistan the highest price for 16GB RAM is around 1500 while in other countries, it is near 2000), but the trend is the same. We can see some outliers in these graphs as well, which just means that some of the brands tend to have high pricing (maybe due to model type - premium). The correlation values in all the countries are positive meaning a strong relationship but they are not higher than 0.5, so we can state there's a moderate relationship between price and RAM size. Also, the coefficients for RAM size are all positive and statistically significant (p-value < 2e-16), indicating that RAM size is a strong predictor of price. From the R-squared values perspective, we can see it ranging from 0.1674 (Pakistan) to 0.2246 (Dubai) which means that from all the factors which influence pricing, RAM size plays a role of proportion of 17% to 22%. So, it's not like a very strong predictor, but still is a good factor to pricing.


### 3. Do Apple devices have a higher price variation across different regions compared to other brands? In which country do Apple devices have the highest markup? Are there brands with more stable pricing across regions?

```{r}
brand_price <- mobiles %>%
  group_by(Company.Name) %>%
  summarise(
    SD_Pakistan = sd(c(USD_Pakistan), na.rm = TRUE),
    SD_India = sd(c(USD_India), na.rm = TRUE),
    SD_China = sd(c(USD_China), na.rm = TRUE),
    SD_USA = sd(c(USD_USA), na.rm = TRUE),
    SD_Dubai = sd(c(USD_Dubai), na.rm = TRUE)
  )

print(brand_price)

apple_price <- mobiles %>%
  filter(Company.Name == "Apple") %>%
  select(USD_Pakistan, USD_India, USD_China, USD_USA, USD_Dubai) %>%
  summarise(
    Max_Price = max(c(USD_Pakistan, USD_India, USD_China, USD_USA, USD_Dubai)),
    Min_Price = min(c(USD_Pakistan, USD_India, USD_China, USD_USA, USD_Dubai)),
    Markup = Max_Price - Min_Price
  )

print(apple_price)
```

In the standard deviation table we can see that Apple's distribution across the countries is mid, because for instance, Honor or Huawei have higher deviation for example in the USA (over 440), but Apple is no more than 330 from all the countries. So, we can say that Apple does not have higher price variation, because brands like Honor, Huawei also Google, Samsung, etc have higher price variations. The markup is the difference between the max price and the min price values. In Dubai, it is 2198.9 and in Pakistan 179.9964 dollars, so the markup would be 2198.9 - 179.9964 = 2018.904 dollars. So, the highest markup, Apple has in Dubai. Apple price variations is different, for example in India 324, while in Dubai 234, but there are brands with more stable price variations, for example, iQOO which has low standard deviation is from 36 to 85. 


### 4. Do all smartphone brands have flagship and budget-friendly models, or do some brands only focus on premium devices?

```{r}
mobiles <- mobiles %>%
  mutate(Category = case_when(
    USD_USA < 300 ~ "Budget",
    USD_USA >= 300 & USD_USA <= 700 ~ "Mid-range",
    USD_USA > 700 ~ "Premium"
  ))

brand <- mobiles %>%
  group_by(Company.Name, Category) %>%
  summarise(Count = n())

print(brand)
```
From the output we can see that Apple, Google, Huawei, Sony have only either mid-range or premium category models, whereas Honor, Motorola, OnePlus, Oppo, Samsung, Tecno, Vivo, Xiaomi have all 3 types: mid-range, budget, premium. Some of them like Infinix, Lenovo, Poco, and Realme have only budget and mid-range, but no premium category models. Nokia, in contrast, has only Budget models and iQOO has only mid-range models.


### 5. Which region offers the most affordable smartphone prices on average? Are there any brands that price their phones significantly lower in one region compared to others?

```{r}
avg_price <- mobiles %>%
  summarise(
    Avg_Price_Pakistan = mean(USD_Pakistan, na.rm = TRUE),
    Avg_Price_India = mean(USD_India, na.rm = TRUE),
    Avg_Price_China = mean(USD_China, na.rm = TRUE),
    Avg_Price_USA = mean(USD_USA, na.rm = TRUE),
    Avg_Price_Dubai = mean(USD_Dubai, na.rm = TRUE)
  )

print(avg_price)


brand_region_price <- mobiles %>%
  group_by(Company.Name) %>%
  summarise(
    Avg_Price_Pakistan = mean(USD_Pakistan, na.rm = TRUE),
    Avg_Price_India = mean(USD_India, na.rm = TRUE),
    Avg_Price_China = mean(USD_China, na.rm = TRUE),
    Avg_Price_USA = mean(USD_USA, na.rm = TRUE),
    Avg_Price_Dubai = mean(USD_Dubai, na.rm = TRUE)
  )

print(brand_region_price)
```
We can see that Pakistan has the lowest average price of 449.9342 dollars, and Dubai has the highest average price of 586.029 dollars. There are companies that offer lower price in one region compared to the other, for example Infinix has low average price in Pakistan - 158.0750 dollars while in Dubai it is 245.8639 and in the USA - 245.0714 dollars. In comparison, Realme and Tecno, for example, have almost stable average price in different regions. 


## Part 2: Visualization


### 1. Plot a bar chart for average price per region in USD.

```{r}
region_avg_price <- data.frame()

for (country in c("USD_Pakistan", "USD_India", "USD_China", "USD_USA", "USD_Dubai")) {
  avg_price <- mean(mobiles[[country]], na.rm = TRUE)
  
  temp <- data.frame(
    Region = country,
    Avg_Price_USD = avg_price
  )
  
  region_avg_price <- rbind(region_avg_price, temp)
}

ggplot(region_avg_price, aes(x = Region, y = Avg_Price_USD, fill = Region)) +
  geom_bar(stat = "identity", show.legend = FALSE) +
  labs(title = "Average Smartphone Price per Region (USD)", 
       x = "Region", 
       y = "Average Price (USD)") +
  theme_minimal() +
  scale_fill_brewer(palette = "Accent") +  
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        plot.title = element_text(face = "bold", hjust = 0.5)) 
```


### 2. Create a pie chart of the market share of smartphone brands.

```{r}
market_share <- mobiles %>%
  group_by(Company.Name) %>%
  summarise(Total_Sales = n()) %>%
  mutate(Market_Share = Total_Sales / sum(Total_Sales) * 100)

ggplot(market_share, aes(x = "", y = Market_Share, fill = Company.Name)) +
  geom_bar(stat = "identity", width = 1, show.legend = TRUE) + 
  coord_polar(theta = "y") + 
  geom_text(aes(label = paste(round(Market_Share, 1), "%")), 
            position = position_stack(vjust = 0.5), size = 3, angle = 45) +  
  labs(title = "Market Share of Smartphone Brands") +
  theme_void() + 
  theme(plot.title = element_text(face = "bold", hjust = 0.5)) +  
  theme(legend.title = element_blank(), 
        legend.text = element_text(size = 10))
```


## Part 3. Recreate


### 1.

```{r}
ggplot(mobiles, aes(x = Company.Name, y = USD_USA, fill = Company.Name)) +
  geom_boxplot(outlier.shape = NA, alpha = 0.7) + 
  geom_jitter(shape = 21, width = 0.2, size = 1, alpha = 0.55, fill = "black") +  
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, size = 6),
        axis.text.y = element_text(size = 6),
        axis.title.x = element_text(size = 10), 
        axis.title.y = element_text(size = 10),
        legend.position = "right", 
        legend.text = element_text(size = 5),  
        legend.title = element_text(size = 9),
        legend.key.height = unit(0.4, "cm"),
        plot.title = element_text(face = "bold", size = 14),  
        plot.subtitle = element_text(face = "italic", size = 9),
        plot.background = element_rect(color = "black", fill = NA, linewidth = 1)
        ) +
  labs(title = "Price Distribution by Company in USA",
       subtitle = "A boxplot showing how the price varies by company, with individual data points overlaid",
       x = "Company", y = "Price in USD", fill = "Company Name")
```


### 2. 

```{r}
ggplot(mobiles, aes(x = Battery.Capacity.mAh, y = USD_USA, color = Company.Name, size = Screen.Size.inches)) +
  geom_point() +  
  labs(
    title = "Battery Capacity vs. Price in USA",
    subtitle = "The relationship between battery capacity, price, and screen size across different smartphone brands",
    x = "Battery Capacity",
    y = "Price",
    color = "Brand"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(size = 6),
    axis.text.y = element_text(size = 6),
    plot.title = element_text(size = 14, face = "bold"),  
    plot.subtitle = element_text(size = 9, face = "italic"),  
    axis.title = element_text(size = 10), 
    legend.title = element_text(size = 9), 
    legend.text = element_text(size = 5), 
    legend.key.size = unit(0.4, "cm"), 
    legend.spacing.y = unit(0.2, "cm"),  
    plot.background = element_rect(color = "black", fill = NA, size = 1) 
  )    +
  scale_size(range = c(0.2, 2.4), guide = "none") 
```


### 3. 

```{r}
top_brands <- c("Apple", "Honor", "Oppo", "Samsung", "Vivo")
filtered_data <- mobiles %>% filter(Company.Name %in% top_brands)

ggplot(filtered_data, aes(x = Battery.Capacity.mAh, 
                          y = Launched.Price.USA.USD, 
                          shape = Company.Name, 
                          color = Screen.Size.inches,
                          size = Battery.Capacity.mAh)) +
  geom_point(alpha = 0.7) +
  scale_shape_manual(values = c(16, 17, 18, 15, 19)) + 
  scale_color_gradient(low = "#274D6A", high = "#73C4F6") + 
  theme_minimal() +
  labs(title = "Battery Capacity vs. Price for Top 5 Brands",
       subtitle = "Different Shapes for Each Brand, Color by Screen Size (USA)",
       x = "Battery Capacity (mAh)",
       y = "Price (USD)",
       color = "Screen Size",
       shape = "Brand") +
  theme(axis.text.x = element_text(size = 6),
        axis.text.y = element_text(size = 6),
        plot.title = element_text(size = 14, face = "bold"),  
        plot.subtitle = element_text(size = 9, face = "italic"),
        axis.title = element_text(size = 10), 
        legend.title = element_text(size = 9), 
        legend.text = element_text(size = 5), 
        legend.key.size = unit(0.4, "cm"), 
        legend.spacing.y = unit(0.2, "cm"),  
        plot.background = element_rect(color = "black", fill = NA, size = 1) ) +
  guides(color = "none") +
  scale_size(range = c(0.2, 2.7), guide = "none") 
```


## Part 4: Explain what else affects the prices of mobile phones. Summarize your findings.

```{r}
ggplot(mobiles, aes(x = Screen.Size.inches, fill = Launched.Price.USA.USD)) +
  geom_density(alpha = 0.5, color = "darkblue", fill = "lightblue") +
  theme_minimal() +
  labs(title = "Density of Screen Size vs. Price",
       x = "Screen Size (inches)",
       y = "Launch Price (USD)")

ggplot(mobiles, aes(x = factor(Launched.Year), y = Launched.Price.USA.USD)) +
  geom_boxplot(alpha = 0.7, fill = "lightyellow", color = "darkorange") +
  theme_minimal() +
  labs(title = "Price Distribution Over Launch Years",
       x = "Launch Year",
       y = "Launch Price (USD)")

weight_and_cameras <- read.csv("weight_and_cameras.csv")

weight_and_cameras$Mobile.Weight <- as.numeric(weight_and_cameras$Mobile.Weight)
weight_and_cameras$Front.Camera <- as.numeric(weight_and_cameras$Front.Camera)
weight_and_cameras$Back.Camera <- as.numeric(weight_and_cameras$Back.Camera)
mobiles$Launched.Price.USA.USD <- as.numeric(mobiles$Launched.Price.USA.USD)

merged_dataset <- data.frame(Mobile.Weight = weight_and_cameras$Mobile.Weight, Front.Camera = weight_and_cameras$Front.Camera, Back.Camera = weight_and_cameras$Back.Camera, Launched.Price.USA.USD = mobiles$Launched.Price.USA.USD)

ggplot(merged_dataset, aes(x = Mobile.Weight, y = Launched.Price.USA.USD)) +
  geom_point(color = "purple", alpha = 0.6) +
  geom_smooth(method = "lm", color = "navy", se = FALSE) +
  labs(title = "Relationship Between Mobile Weight and Price",
       x = "Mobile Weight (g)",
       y = "Price (USD)") +
  theme_minimal()

merged_dataset <- merged_dataset %>%
  mutate(
    Front.Camera.Binned = cut(Front.Camera, breaks = c(0, 8, 16, 32, 64, Inf), labels = c("0-8MP", "9-16MP", "17-32MP", "33-64MP", "65+MP")),
    Back.Camera.Binned = cut(Back.Camera, breaks = c(0, 8, 16, 32, 64, Inf), labels = c("0-8MP", "9-16MP", "17-32MP", "33-64MP", "65+MP"))
  )

ggplot(merged_dataset, aes(x = factor(Front.Camera.Binned), y = Launched.Price.USA.USD)) +
  geom_boxplot(alpha = 0.7, fill = "lightgreen", color = "darkgreen") +
  theme_minimal() +
  labs(title = "Price Distribution by Front Camera Resolution",
       x = "Front Camera Resolution (MP)",
       y = "Launch Price (USD)")

ggplot(merged_dataset, aes(x = factor(Back.Camera.Binned), y = Launched.Price.USA.USD)) +
  geom_boxplot(alpha = 0.7, fill = "lightcoral", color = "darkred") +
  theme_minimal() +
  labs(title = "Price Distribution by Back Camera Resolution",
       x = "Back Camera Resolution (MP)",
       y = "Launch Price (USD)")
```

Having the density function graph of price and screen size we can see that those models who have screen size of 6 inches to 7 inches have higher prices rather than those who have bigger screen sizes. Even more, we can see that higher screen sized models are as cheap as the ones who have smaller screen size. So even without statistic analysis, we can say that there is no positive correlation between screen size and price. Now, looking at the boxplot of price and launched year, we can say that the ones launched in 2014 and 2016 have lower prices and less variation, but starting from 2017 median prices and variation increased. Also, IQR became wider, which means that both budget and premium classed smartphones became widespread. Also, some outliers from 2020 to 2025, can suggest that there were new models created such as maybe premium category was created during that time. As, we also can see the median from 2017 to 2018 increased, meaning the prices of smartphones increased. Then, in 2018 to 2021 it decreased, then from 2021 to 2022 again increased then, from 2022-2023 decreased and 2023-2024 increased slightly. If we now take 2017 and 2024 we can see that regardless some variations, the median is almost the same, meaning that smartphones in 2017 costed almost the same as in 2024, even tho in 2017 there were less variations compared to 2024, and premium category was not yet introduced. (I don't observe 2025 as the year has yet started, and also, not enough data to do conclusions on 2025) So, we can say that prices are influenced by launched year, however, the relationship is not linear, as we see some dramatic changes over years (increasing from one year to another, and decreasing from one year to another). In the scatterplot of mobiles' weights and prices we can see a very slight upward slope of the line, which means that as mobile weight increases, price also increases but very slightly. Also, mobiles with weights of approximately 100g to 200g have wide range of prices - from very cheap to expensive. Moreover, phones with 400g and more weight tend to have higher price, although there are less points, which can suggest that these points may be the phones that are from mid-range to premium class sold at high prices. So, a weight obviously has some influence on price formatting, but it is not a strong predictor of the price like in the example of RAM. Looking at the front camera and price relationship, we can see that the models who have front camera resolution of 0-8MP have the lowest median price, while the ones having the highest resolution of front camera - 65+MP have the highest median price. For the 9-16MP category we see the widest IQR which means that many price segments appear in this category. We can say, that front camera influences the price formation in some sense, because as we see the lowest category of 0-8MP has the lowest median price whereas the highest category which is 65+MP has the highest mdeian price, however, the relationship is not linear as we see from 9-16MP to 17-32MP there's a median drop, and then in 33-64MP again median increase. Moving to the boxplot of back camera and price, we can see that the category of 17-32MP has the highest median price, while the highest resolution categories as 33-64MP and 65+MP have lower median price. However, we have lots of outlier points on these high resolution segments, which suggests that premium models tend to have these type of resolution parameter. If we compare these two categories: back camera and front camera, we can suggest that back camera influences price formation stronger than front camera, because in back camera box plot we can say "as resolution becomes bigger, price increases as well" the outlier points confirm this as well, however in front camera boxplot we can see outlier points at lower resolution parts, which suggests that linear relationship is not present, but only comparing the medians and IQR we can suggest a slight relationship of front camera on price formation.












